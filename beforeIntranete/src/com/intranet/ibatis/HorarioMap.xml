<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="horario">

	<select id="buscarHorario" parameterType="com.intranet.bean.Usuario"
		resultType="com.intranet.horario.bean.HorarioConNombre">
		SELECT c.desccurso,h.descHorario,h.hora_iniciio,h.hora_fin
		FROM alumno al join detalle_alumnoinscripcion dai
		on al.idalumno=dai.idalumno join inscripcion i
		on dai.idinscripcion=i.idinscripcion join periodo p
		on i.idperiodo= p.idperiodo join detalle_inscricurso dic
		on i.idinscripcion=dic.idinscripcion join detalle_cursoseccion dcs
		on dic.idcursoseccion=dcs.idcursoseccion left join horario h
		on dcs.idcursoseccion=h.idcursoseccion join curso c
		on dcs.idcurso=c.idcurso
		where al.idalumno=(select alum.idalumno from usuario u join alumno alum
		on u.idusuario=alum.idusuario where u.idusuario=#{idUsuario})
		and p.idperiodo = (select idperiodo from periodo order by idperiodo desc
		limit 1
		)
	</select>
</mapper>
